---
title: ìƒíƒœê´€ë¦¬, MobX ì´í•´ì™€ ì‚¬ìš©ë²•
date: '2022-06-08'
summary: OOPì ì¸ ìƒíƒœê´€ë¦¬ë¥¼ ìœ„í•œ Mobx
publish: true
---

# ìƒíƒœê´€ë¦¬

- **useState** ëŒ€ì‹  ë³µì¡í•œ êµ¬ì¡°ì˜ ìƒíƒœ ê´€ë¦¬ ê°€ëŠ¥
- ìƒíƒœ ê´€ë¦¬ ì½”ë“œë¥¼ ìƒíƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì™€ ë¶„ë¦¬í•´ì„œ **ìœ ì§€ë³´ìˆ˜**
- **ë¯¸ë“¤ì›¨ì–´**ë“¤ì„ í†µí•´ ë¹„ë™ê¸° ì²˜ë¦¬ ë° ìƒíƒœ ì²˜ë¦¬ ê°€ëŠ¥

ê°„ëµíˆ ìœ„ì™€ ê°™ì€ ì¥ì ë“¤ë¡œ ê±°ì˜ **React í”„ë¡œì íŠ¸**ì™€ **ì „ì—­ ìƒíƒœê´€ë¦¬**ëŠ” ë–¼ë ¤ì•¼ ë—„ ìˆ˜ ì—†ëŠ” ìˆ˜ì¤€ì´ ë˜ë²„ë ¸ìŠµë‹ˆë‹¤. ğŸ¤“

`Redux`, `MobX`, `Recoil` ë“±ë“± ìˆ˜ ë§ì€ **ìƒíƒœê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬**ê°€ ë‚˜ì˜¤ê³  ìˆê³ 

ì˜¤ëŠ˜ì€ **MobX**ë¥¼ ì¤‘ì ìœ¼ë¡œ ì‚´í´ë´…ì‹œë‹¤. ğŸ˜

# ê¸°ì¡´ì˜ ìƒíƒœê´€ë¦¬, Redux

ì „ì—­ ìƒíƒœê´€ë¦¬ í•˜ë©´ ë°”ë¡œ ë– ì˜¤ë¥´ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” `Redux`ì…ë‹ˆë‹¤.
ì‚¬ì‹¤ìƒ ìƒíƒœê´€ë¦¬ì˜ êµê³¼ì„œë¼ê³  ë¶ˆë¦´ ë§Œí¼ ìˆ˜ ë§ì€ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ë°ìš”.

`Redux`ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ **ë³µì¡í•œ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ**ê°€ í•„ìš”í•˜ê³ 

ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•´ **ë³„ë„ì˜ ë¯¸ë“¤ì›¨ì–´ (Redux-thunk, Redux-saga)** ë“±ì„ ì„¤ì¹˜í•´ì•¼ ëœë‹¤ëŠ” **ë¶ˆí¸í•¨**ì´ ì¡´ì¬í•©ë‹ˆë‹¤.

ë˜í•œ **Immutable**ì ì¸ **Store** ë•ë¶„ì— ì €í¬ëŠ” í•­ìƒ ìƒˆë¡œìš´ ìƒíƒœ ê°’ì„ **Store**ì— ë°˜í™˜í•´ì¤˜ì•¼ í•˜ê³ 
í•˜ë‚˜ì˜ **Store**ë§Œì„ Providerì— ë“±ë¡í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.

> ìµœê·¼ `Redux-toolkit`ì˜ ë“±ì¥ìœ¼ë¡œ ìœ„ì™€ ê°™ì€ ë¶ˆí¸í•¨ë“¤ì´ ì¼ë¶€ í•´ì†Œë˜ê¸´ í–ˆìŠµë‹ˆë‹¤.

# MobX!

`MobX`ëŠ” Reduxì˜ ë¶ˆí¸í•¨ì„ í•´ì†Œí•˜ê³  ê¸°ì¡´ì˜ `Funtional Programming`ì ì¸ Reduxì˜ êµ¬ì„±ì—ì„œ ë²—ì–´ë‚˜ ì¡°ê¸ˆ ë” `OOP` ì ì´ê²Œ **ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬**ì…ë‹ˆë‹¤.

**Singleton** í˜•íƒœë¡œ êµ¬ì„±ëœ ìƒíƒœ(class)ë¥¼ **React Context**ë¥¼ í†µí•´ **ì „ì—­ ìƒíƒœ**ë¡œ ê´€ë¦¬í•˜ê³ 
ë‹¨ìˆœí•œ ë¡œì»¬ ìƒíƒœ ë˜í•œ ê´€ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

**í•˜ì§€ë§Œ**, [ê³µì‹ ë¬¸ì„œ](https://ko.mobx.js.org/the-gist-of-mobx.html)ì—ì„œë„ ë§í•˜ê¸¸ **ë†’ì€ ììœ ë„**ë¡œ ì¸í•´ **ì •ë‹µì¸ MobX êµ¬ì¡°ëŠ” ì—†ì–´ì„œ**
**ëŸ¬ë‹ ì»¤ë¸Œ**ê°€ ë‚®ì§€ë§Œ ìµœì í™”ëœ êµ¬ì¡°ë¥¼ ì ìš©í•  ë•Œê¹Œì§€ **_ë§Œë§Œì¹˜ ì•Šì€_ ëŸ¬ë‹ ì»¤ë¸Œ**ë¥¼ ê°–ê²Œ ë  ê²ƒ ê°™ê¸°ë„ í•©ë‹ˆë‹¤..ğŸ¥²

## MobX Core

`MobX`ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ **ì„¸ ê°€ì§€** ì˜ ì¤‘ìš”í•œ ê°œë…ì´ ì¡´ì¬í•©ë‹ˆë‹¤.

- **ìƒíƒœ (state)**
  - ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ë™í•˜ëŠ” ë°ì´í„° (ì¼ë°˜ ê°ì²´, ë°°ì—´, í´ë˜ìŠ¤, ìˆœí™˜ ë°ì´í„° êµ¬ì¡° ë˜ëŠ” ì°¸ì¡°)
  - **Class** ë¥¼ í†µí•´ ì£¼ë¡œ ì œì‘ (OOP ğŸ¤“)
  - ì½”ë“œì— `observable`ë¡œ í‘œì‹œë¥¼ í†µí•´ **MobX**ê°€ ì¶”ì í•  ìˆ˜ ìˆë„ë¡ `(ì¤‘ìš”!)`

```js
export class CounterStore {
  count = 0;

  constructor() {
    makeObservable(this, {
      count: observable,
    });
  }
}
```

- **ë™ì‘ (action)**

  - **observable**í•œ ê°’ì„ ë³€í™” ì‹œí‚¤ëŠ” í–‰ë™
  - ì½”ë“œì— `action` í‘œì‹œë¥¼ í†µí•´ MobXê°€ íŠ¸ëœì­ì…˜ì„ ìë™ìœ¼ë¡œ ì ìš©í•˜ì—¬ ì„±ëŠ¥ì„ ì‰½ê²Œ ìµœì í™”

- **íŒŒìƒ (derivation)**
  - **observable state**ì˜ ë³€í™”ë¡œ ì¸í•´ íŒŒìƒë  ìˆ˜ ìˆëŠ” ëª¨ë“  ê²ƒì´ `derivation`
  - MobXëŠ” ë‹¤ìŒê³¼ ê°™ì´ **ë‘ ì¢…ë¥˜**ë¡œ `derivation`ì„ êµ¬ë¶„í•©ë‹ˆë‹¤.
    1.  **computed** ê°’: í˜„ì¬ **observable state**ë¥¼ í†µí•´ íŒŒìƒ(ìƒì„±)ë  ìˆ˜ ìˆëŠ” ê°’
        - **JS getter í•¨ìˆ˜ getì„ ì‚¬ìš©**í•˜ì—¬ ì†ì„±ì„ ì •ì˜í•˜ê³  `computed`ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.
    2.  **reaction** ê°’: **observable state**ê°€ ë³€ê²½ë  ë•Œ ìë™ìœ¼ë¡œ ë°œìƒí•´ì•¼ í•˜ëŠ” ë¶€ìˆ˜íš¨ê³¼
        - ê°’ì„ ë°˜í™˜í•˜ëŠ” ëŒ€ì‹  ì½˜ì†” ì¶œë ¥, ë„¤íŠ¸ì›Œí¬ ìš”ì²­, DOM íŒ¨ì¹˜ ì ìš©ì„ ìœ„í•´ React ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë“±ì˜ ë¶€ìˆ˜íš¨ê³¼

```js
export class CounterStore {
  count = 0;

  constructor() {
    makeObservable(this, {
      count: observable,
      increase: action,
      decrease: action,
      getCount: computed,
    });
  }

  get getDoubleCount() {
    return this.count * 2; // í˜„ì¬ stateê°€ ë³€í™”í•˜ë©´ ìë™ìœ¼ë¡œ ê°’ì„ ì—…ë°ì´íŠ¸
  }

  increase = () => {
    this.count += 1;
  };

  decrease = () => {
    this.count -= 1;
  };
}
```

## MobX Flow

<Image
  width="720"
  height={200}
  src={'/posts/2022/06/mobx-tutorial/mobx-flow.png'}
/>

`ë‹¨ë°©í–¥ ë°ì´í„° íë¦„`ìœ¼ë¡œ **action**ì„ í†µí•´ **state (observable state)** ì— ë³€í™”ê°€ ìƒê¸°ë©´
í•´ë‹¹ **state**ë¥¼ ì‚¬ìš©í•˜ëŠ” **view**ê°€ ë‹¤ì‹œ ë Œë”ë§ë˜ê³ , **computed** & **reaction** ë“± state ë³€í™”ë¡œ ì¸í•´ íŒŒìƒ ëœ í–‰ë™ë“¤ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.

## MobX ì˜ˆì œ

> ë°ì½”ë ˆì´í„°ë¥¼ v6 ë¶€í„°ëŠ” ê¶Œì¥í•˜ì§€ ì•Šê³  **makeObservable, makeAutoObservable**ë¥¼ í†µí•´ ì§€ì •í•¨

### 1. Store ì„¤ì • / count.js

```js
import { createContext, useContext } from 'react';
import { makeObservable, observable, action, computed } from 'mobx';

// class ì‚¬ìš©
class CounterStore {
  count = 0;

  constructor() {
    makeObservable(this, {
      count: observable,
      increase: action,
      decrease: action,
    });
  }

  increase = () => {
    this.count += 1;
  };

  decrease = () => {
    this.count -= 1;
  };
}

export const counterStore = new CounterStore(); // ë ˆí¼ëŸ°ìŠ¤ ìƒì„±
const CounterStoreContext = createContext(counterStore);
// Context ì‚¬ìš©ì„ ìœ„í•œ Hook
export const useCounterStore = () => useContext(CounterStoreContext);
```

### 2. Provider ì„¤ì • / App.js

```js
import { Provider } from 'mobx-react';

const stores = {
  counterStore,
};

function App() {
  // Providerë¥¼ í†µí•´ store ì „ë‹¬
  return <Provider {...stores}>...</Provider>;
}
```

### 3. Context ì‚¬ìš© / Count.jsx

```js
import { observer } from 'mobx-react';
import { useCounterStore } from 'store/count';

function Count() {
  // hook í˜•ì‹ìœ¼ë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  const { count, increase, decrease } = useCounterStore();

  return (
    <div>
      <h1>Count</h1>
      <h2>{count}</h2>
      <button onClick={increase}>ì¦ê°€</button>
      <button onClick={decrease}>ê°ì†Œ</button>
    </div>
  );
}

// observable stateë¥¼ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” observer ì„¤ì •ì„ ë°˜ë“œì‹œ í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.
export default observer(Count);
```

## ë²ˆì™¸. ì „ì—­ ìŠ¤í† ì–´ ì ‘ê·¼ Hook ë§Œë“¤ê¸° / useStore

```js
import { useContext } from 'react';
import { MobXProviderContext } from 'mobx-react';

function useStore() {
  return useContext(MobXProviderContext);
}

export default useStore;
```

```js
function Count() {
  const { counterStore } = useStore();

  return (
    ...
  );
}
```

ì»´í¬ë„ŒíŠ¸ë³„ë¡œ **useContext**ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  MobXì—ì„œ ì œê³µí•˜ëŠ” `MobXProviderContext`ë¥¼ ì´ìš©í•˜ì—¬
**ì „ì—­ ìŠ¤í† ì–´ì— ì ‘ê·¼ê°€ëŠ¥í•œ Hook**êµ¬í˜„ ë˜í•œ ê°€ëŠ¥í•©ë‹ˆë‹¤. âœ¨
